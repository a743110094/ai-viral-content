<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIè°ƒè¯•æµ‹è¯• - Ice King AI</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 30px;
            backdrop-filter: blur(16px);
        }
        h1 {
            text-align: center;
            color: #60a5fa;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #cbd5e1;
        }
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #374151;
            border-radius: 8px;
            background: rgba(31, 41, 55, 0.8);
            color: white;
            font-size: 14px;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        button {
            background: linear-gradient(45deg, #f59e0b, #f97316);
            color: #1f2937;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background: linear-gradient(45deg, #d97706, #ea580c);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .result {
            margin-top: 20px;
            padding: 20px;
            background: rgba(31, 41, 55, 0.6);
            border-radius: 8px;
            border: 1px solid #374151;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            border-color: #10b981;
            color: #10b981;
        }
        .error {
            border-color: #ef4444;
            color: #ef4444;
        }
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #374151;
            border-radius: 50%;
            border-top-color: #60a5fa;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #374151;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: #9ca3af;
        }
        .tab.active {
            color: #60a5fa;
            border-bottom-color: #60a5fa;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª APIè°ƒè¯•æµ‹è¯•å·¥å…·</h1>
        
        <div class="info">
            <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>
            <ul>
                <li><strong>æ™®é€šç”Ÿæˆ</strong>ï¼šä½¿ç”¨ç¼“å­˜ï¼Œæ­£å¸¸APIè°ƒç”¨</li>
                <li><strong>å¼ºåˆ¶APIè°ƒç”¨</strong>ï¼šè·³è¿‡ç¼“å­˜ï¼Œå¼ºåˆ¶è°ƒç”¨å¤§æ¨¡å‹API</li>
                <li><strong>ç®€å•æµ‹è¯•</strong>ï¼šæœ€å°åŒ–è¾“å…¥çš„å¿«é€ŸAPIæµ‹è¯•</li>
            </ul>
            <p><strong>æ³¨æ„</strong>ï¼šå¼ºåˆ¶APIè°ƒç”¨ä¼šäº§ç”ŸçœŸå®è´¹ç”¨ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼</p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('full')">å®Œæ•´æµ‹è¯•</div>
            <div class="tab" onclick="switchTab('force')">å¼ºåˆ¶APIè°ƒç”¨</div>
            <div class="tab" onclick="switchTab('simple')">ç®€å•æµ‹è¯•</div>
        </div>

        <!-- å®Œæ•´æµ‹è¯• -->
        <div id="full" class="tab-content active">
            <form id="fullForm">
                <div class="form-group">
                    <label>é¢†åŸŸ/è¯é¢˜ *</label>
                    <textarea id="fullNiche" placeholder="ä¾‹å¦‚ï¼šAIç”Ÿäº§åŠ›å·¥å…·"></textarea>
                </div>
                <div class="form-group">
                    <label>ç›®æ ‡å—ä¼— *</label>
                    <textarea id="fullAudience" placeholder="ä¾‹å¦‚ï¼šç§‘æŠ€åˆ›ä¸šè€…"></textarea>
                </div>
                <div class="form-group">
                    <label>äº§å“é“¾æ¥</label>
                    <input type="url" id="fullProduct" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label>æ–‡æ¡ˆé£æ ¼</label>
                    <select id="fullTone">
                        <option value="Professional">ä¸“ä¸šæƒå¨</option>
                        <option value="Humorous">å¹½é»˜é£è¶£</option>
                        <option value="Luxury">é«˜ç«¯å¥¢å</option>
                        <option value="Inspiring">åŠ±å¿—æ¿€åŠ±</option>
                        <option value="Aggressive Marketing">å¼ºåŠ¿è¥é”€</option>
                        <option value="Friendly Mentor">äº²åˆ‡å¯¼å¸ˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>è¥é”€ç›®æ ‡</label>
                    <select id="fullGoal">
                        <option value="Grow Followers">æ¶¨ç²‰å¼•æµ</option>
                        <option value="Drive Affiliate Clicks">æ¨å¹¿ç‚¹å‡»</option>
                        <option value="Sell Product">äº§å“é”€å”®</option>
                        <option value="Build Brand Awareness">å“ç‰Œæ›å…‰</option>
                    </select>
                </div>
                <button type="submit">ğŸš€ ç”Ÿæˆå†…å®¹ (ä½¿ç”¨ç¼“å­˜)</button>
            </form>
        </div>

        <!-- å¼ºåˆ¶APIè°ƒç”¨ -->
        <div id="force" class="tab-content">
            <form id="forceForm">
                <div class="form-group">
                    <label>é¢†åŸŸ/è¯é¢˜ *</label>
                    <textarea id="forceNiche" placeholder="ä¾‹å¦‚ï¼šAIç”Ÿäº§åŠ›å·¥å…·"></textarea>
                </div>
                <div class="form-group">
                    <label>ç›®æ ‡å—ä¼— *</label>
                    <textarea id="forceAudience" placeholder="ä¾‹å¦‚ï¼šç§‘æŠ€åˆ›ä¸šè€…"></textarea>
                </div>
                <div class="form-group">
                    <label>äº§å“é“¾æ¥</label>
                    <input type="url" id="forceProduct" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label>æ–‡æ¡ˆé£æ ¼</label>
                    <select id="forceTone">
                        <option value="Professional">ä¸“ä¸šæƒå¨</option>
                        <option value="Humorous">å¹½é»˜é£è¶£</option>
                        <option value="Luxury">é«˜ç«¯å¥¢å</option>
                        <option value="Inspiring">åŠ±å¿—æ¿€åŠ±</option>
                        <option value="Aggressive Marketing">å¼ºåŠ¿è¥é”€</option>
                        <option value="Friendly Mentor">äº²åˆ‡å¯¼å¸ˆ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>è¥é”€ç›®æ ‡</label>
                    <select id="forceGoal">
                        <option value="Grow Followers">æ¶¨ç²‰å¼•æµ</option>
                        <option value="Drive Affiliate Clicks">æ¨å¹¿ç‚¹å‡»</option>
                        <option value="Sell Product">äº§å“é”€å”®</option>
                        <option value="Build Brand Awareness">å“ç‰Œæ›å…‰</option>
                    </select>
                </div>
                <button type="submit">âš¡ å¼ºåˆ¶APIè°ƒç”¨ (è·³è¿‡ç¼“å­˜)</button>
            </form>
        </div>

        <!-- ç®€å•æµ‹è¯• -->
        <div id="simple" class="tab-content">
            <div class="info">
                <p>ä½¿ç”¨é»˜è®¤å‚æ•°è¿›è¡Œå¿«é€ŸAPIæµ‹è¯•ï¼Œè¿™å°†è°ƒç”¨çœŸå®çš„APIå¹¶äº§ç”Ÿè´¹ç”¨ã€‚</p>
            </div>
            <button onclick="simpleTest()">ğŸ”¬ ç®€å•APIæµ‹è¯•</button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>æ­£åœ¨è°ƒç”¨APIï¼Œè¯·ç¨å€™...</p>
        </div>

        <div class="result" id="result"></div>
    </div>

    <script>
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰tabå†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰tabçš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„tabå†…å®¹
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('result').innerHTML = '';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showResult(data, isError = false) {
            hideLoading();
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result ' + (isError ? 'error' : 'success');
            resultDiv.textContent = JSON.stringify(data, null, 2);
        }

        // å®Œæ•´è¡¨å•æäº¤
        document.getElementById('fullForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const inputs = {
                niche: document.getElementById('fullNiche').value,
                targetAudience: document.getElementById('fullAudience').value,
                productLink: document.getElementById('fullProduct').value,
                tone: document.getElementById('fullTone').value,
                mainGoal: document.getElementById('fullGoal').value
            };

            showLoading();
            
            try {
                const response = await fetch('/api/content/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        inputs,
                        config: {
                            forceApiCall: false
                        }
                    })
                });
                
                const data = await response.json();
                showResult(data, !response.ok);
            } catch (error) {
                showResult({ error: error.message }, true);
            }
        });

        // å¼ºåˆ¶APIè¡¨å•æäº¤
        document.getElementById('forceForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const inputs = {
                niche: document.getElementById('forceNiche').value,
                targetAudience: document.getElementById('forceAudience').value,
                productLink: document.getElementById('forceProduct').value,
                tone: document.getElementById('forceTone').value,
                mainGoal: document.getElementById('forceGoal').value
            };

            showLoading();
            
            try {
                const response = await fetch('/api/content/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        inputs,
                        config: {
                            forceApiCall: true
                        }
                    })
                });
                
                const data = await response.json();
                showResult(data, !response.ok);
            } catch (error) {
                showResult({ error: error.message }, true);
            }
        });

        // ç®€å•æµ‹è¯•
        async function simpleTest() {
            showLoading();
            
            try {
                const response = await fetch('/api/debug/generate?test=api');
                const data = await response.json();
                showResult(data, !response.ok);
            } catch (error) {
                showResult({ error: error.message }, true);
            }
        }
    </script>
</body>
</html>