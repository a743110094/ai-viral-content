# 控制台日志测试指南

## 🎯 立即验证API调用

我已经创建了专门的测试工具，让您能在控制台看到真实的API调用日志。

## 🚀 快速测试步骤

### 1. 启动开发服务器
```bash
cd ice-king-ai-next
npm run dev
```

### 2. 打开测试页面
在浏览器中访问：**http://localhost:3000/simple-test.html**

### 3. 查看控制台日志
**重要：** 按 `F12` 打开开发者工具，切换到"Console"（控制台）标签页

### 4. 运行测试
点击页面上的"🚀 开始简单API测试"按钮

## 📊 您将看到的控制台日志

### 成功调用的日志示例：
```
🚀 ====== 开始简单API测试 ======
📅 测试时间: 2025-12-01T16:41:20.381Z
🔑 API密钥状态: 已配置
🌐 API地址: https://api.openai.com/v1
📋 环境变量: {OPENAI_API_KEY: "sk-proj-...", OPENAI_BASE_URL: "https://api.openai.com/v1"}

🤖 初始化OpenAI客户端...
✅ OpenAI客户端初始化成功

📞 准备调用OpenAI API...
📝 请求参数: {model: "gpt-3.5-turbo", messages: [...], max_tokens: 50}
⏰ 开始API调用，时间: 2025-12-01T16:41:21.123Z

🎉 API调用成功完成!
⏱️ 调用耗时: 2847ms
📊 响应详情: {
  model: "gpt-3.5-turbo",
  usage: {prompt_tokens: 15, completion_tokens: 12, total_tokens: 27},
  finishReason: "stop",
  content: "API test successful"
}

✅ 测试完成，返回结果
🚀 ====== API测试结束 ======
```

## 🔍 其他测试方法

### 方法2：直接API调用
```bash
# 在终端中运行
curl http://localhost:3000/api/simple-test
```

### 方法3：完整内容生成测试
访问：**http://localhost:3000/debug.html**
- 选择"强制API调用"模式
- 提交表单
- 观察控制台日志

## 🐛 如果看不到日志

### 检查项目是否启动
确认看到以下启动信息：
```
Local:    http://localhost:3000/
Network:  http://192.168.1.100:3000/
```

### 检查环境变量
确保在 `.env.local` 中配置了：
```env
OPENAI_API_KEY=your_api_key_here
```

### 检查浏览器控制台
- 确保打开了开发者工具（F12）
- 确保在"Console"标签页
- 确保没有过滤日志

## 🎯 成功标志

当您看到以下信息时，说明真正调用了API：

1. **API调用耗时**：通常2-5秒（不是瞬间响应）
2. **Token使用信息**：`usage: {prompt_tokens: 15, completion_tokens: 12, total_tokens: 27}`
3. **AI响应内容**：实际的AI生成内容
4. **调用详情**：请求参数、响应时间等

## ❌ 常见错误日志

### API密钥未配置
```
❌ 错误: API密钥未配置
🔑 API密钥状态: 未配置
```

### 网络错误
```
❌ API调用失败!
🔍 错误详情: {name: "FetchError", message: "fetch failed"}
🌍 错误类型: 网络连接失败
```

### API密钥无效
```
❌ API调用失败!
🔍 错误详情: {name: "OpenAIError", message: "Invalid API key provided"}
🔐 错误类型: API密钥无效或已过期
```

## 💡 调试提示

1. **日志级别**：确保控制台设置为"Verbose"或"All"
2. **网络面板**：在开发者工具的Network标签中查看请求
3. **响应验证**：检查API响应中是否包含真实的AI生成内容

---

**现在您可以确信系统真正调用大模型API了！**